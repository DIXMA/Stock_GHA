{% extends 'base.html' %}

{% block content %}

    <div class="row">
        <div class="col-md-12">
            <div class="box box-default">
                <div class="box-header">
                    <h3>Detalles del Proyecto</h3>
                    <div class="box-tools pull-right">
                        <a href="#" class="btn btn-default">
                            Gestion del Proyecto
                        </a>
                        <button class="btn btn-default">
                            Estado
                        </button>
                    </div>
                </div>
                <div class="box-body">
                    <table class="table table-responsive">
                        <tbody>
                        <tr>
                            <th>Cliente</th>
                            <th>Nit</th>
                            <th>Fecha Inicio</th>
                            <th>Proyecto</th>
                        </tr>
                        <tr>
                            <td>{{ project.client.name }}</td>
                            <td>{{ project.client.nit }}</td>
                            <td>{{ project.init_date }}</td>
                            <td>{{ project.id }}</td>
                        </tr>
                        <tr>
                            <th colspan="4">Requerimientos Iniciales</th>
                        </tr>
                        <tr>
                            <td colspan="4">{{ project.init_requirements }}</td>
                        </tr>
                        <tr>
                            <th colspan="4">Diseño Preliminar</th>
                        </tr>
                        <tr>
                            <td><img src="{{ project.init_design.url }}"></td>
                        </tr>
                        </tbody>
                    </table>

                    <hr/>
                    <h3>COTIZACIÓN</h3>
                    <hr/>
                    {% if quotation %}
                        <a href="{% url 'projects_quotation_create' pr_pk=project.id %}"
                           class="btn btn-primary pull-right">
                            Administrar Cotización
                        </a>
                        <table class="table table-responsive">
                            <thead>
                            <tr>
                                <th>Referencia</th>
                                <th>Valor Uni</th>
                                <th>Cantidad</th>
                                <th>Valor Total</th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for prq in products_quotation %}
                                <tr>
                                    <td>{{ prq.product.reference }}</td>
                                    <td>{{ prq.product.price_lm }}</td>
                                    <td>{{ prq.quantity }}</td>
                                    <td>{{ prq.total }}</td>
                                </tr>
                            {% endfor %}
                            <tr>
                                <th>TOTAL</th>
                                <td>{{ quotation.price }}</td>
                            </tr>
                            </tbody>
                        </table>
                    {% else %}
                        <a href="{% url 'projects_quotation_create' pr_pk=project.id %}"
                           class="btn btn-primary pull-right">
                            Crear Cotización
                        </a>
                    {% endif %}

                    <hr/>
                    <h3>Personal</h3>
                    <hr/>
                    {% if personal_project %}
                        <a href="{% url 'project_personal' pr_pk=project.id %}"
                           class="btn btn-primary pull-right">
                            Administrar Personal
                        </a>
                        <table class="table table-responsive">
                            <thead>
                            <tr>
                                <td>Proceso</td>
                                <td>Especialidad</td>
                                <td>Costo Horas</td>
                                <td>Horas Trabajadas</td>
                                <td>Total</td>
                            </tr>
                            </thead>
                            <tbody>
                            {% for px in personal_project %}
                                <tr>
                                    <td>{{ px.process }}</td>
                                    <td>{{ px.specialty }}</td>
                                    <td>{{ px.hour_price }}</td>
                                    <td>{{ px.hour_work }}</td>
                                    <td>{{ px.total_price }}</td>
                                </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                    {% else %}
                        <a href="{% url 'project_personal' pr_pk=project.id %}"
                           class="btn btn-primary pull-right">
                            Agrear Personal
                        </a>
                    {% endif %}

                    <hr/>
                    <h3>Servicios Externos</h3>
                    <hr/>
                    {% if external_services %}
                        <a href="{% url 'project_external_services' pr_pk=project.id %}"
                           class="btn btn-primary pull-right">Administrar Servicios</a>
                        <table class="table table-responsive">
                            <thead>
                            <tr>
                                <td>Proceso</td>
                                <td>Valor Unit</td>
                                <td>Cantidad</td>
                                <td>Precio Total</td>
                            </tr>
                            </thead>
                            <tbody id="exs_add">
                            {% for exs in external_services %}
                                <tr>
                                    <td>{{ exs.process }}</td>
                                    <td>{{ exs.unit_price }}</td>
                                    <td>{{ exs.quantity }}</td>
                                    <td>{{ exs.total_price }}</td>
                                </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                    {% else %}
                        <a href="{% url 'project_external_services' pr_pk=project.id %}"
                           class="btn btn-primary pull-right">
                            Agrear Servicios</a>
                    {% endif %}

                    <hr/>
                    <h3>Liquidación</h3>
                    <hr/>
                </div>
            </div>
        </div>
    </div>

{% endblock %}